# 							 NOIP Day2 

| 题目名称       | 排队      | 选ID       | 生日         |
| -------------- | --------- | ---------- | ------------ |
| 题目类型       | 传统型    | 传统型     | 传统型       |
| 输入文件名     | queue.in  | choose.in  | birthday.in  |
| 输出文件名     | queue.out | choose.out | birthday.out |
| 每个测试点时限 | 1s        | 1s         | 1s           |
| 内存限制       | 256M      | 512M       | 256M         |
| 测试点数目     | 10        | 20         | 10           |
| 每个测试点分值 | 10        | 5          | 10           |

提交源程序文件名

| 对于C++   语言 | queue.cpp | choose.cpp | birthday.cpp |
| -------------- | --------- | ---------- | ------------ |
| 对于C     语言 | queue.c   | choose.c   | birthday.c   |
| 对于Pascal语言 | queue.pas | choose.pas | birthday.pas |

编译选项

| 对于C++   语言 | -lm  | -lm  | -lm  |
| -------------- | ---- | ---- | ---- |
| 对于C     语言 | -lm  | -lm  | -lm  |
| 对于Pascal语言 |      |      |      |



## Problem 1 排队(queue.cpp/1s/256m)

 

### Description

抢饭是高中生活的一部分,现在有一列队伍长度为n，(**注意：由于人与人之间要保持距离，且不同情况所保持的距离大小不同，所以长度并不能直接体现队列的人数)**.已知男男之间的距离为a，男女之间距离为b，女女之间距离为c。一个男生打饭时间为d，一个女生打饭时间为e,求所有情况的排队时间总和(忽略身体的大小对队伍长度的贡献),答案对1000000007取模

### Input Format

一行6个正整数，分别表示n,a,b,c,d,e

### Output Format

一行一个整数，即答案

### Sample

#### Input1

```
1 1 1 1 1 2
```

#### Output1

```
12
```

#### Input2

```
5 1 3 1 2 2
```

#### Output2

```
72
```

#### Input3

```
989212 12 13 18 7 9
```

#### Output3

```
366364320
```


### Constraints

对于50%的数据,保证L<10^6

对于100%的数据,保证L<10^18 a,b,c,d,e<=30,a,b,c<=n



## Problem 2 选ID (choose.cpp/choose.in/choose.out)

### Description 

机房似乎有许多人没有ID，热心同志小A为了服务人民（??），所有决定帮大家找一个合适的ID。

小A觉得一个合适的ID，和这个人的相关程度应该是比较高的，就像他的ID里有他的名字缩写一样。 为了量化这个相关程度，他定义一个人的名字S和他的id T的匹配值的大小为lcp(S,T)。现在有n个人，小A想好了n个id，他想知道如果把ID分配给机房众人，最后能够得到的最大的匹配值之和是多少。

### Input Format

第一行一个n，表示人数。

第2行到第n+1行，每行一个字符串，表示一个人的姓名N；

第n+2行到第2*n+1行，每行一个字符串，表示一个ID；

保证姓名和ID只包含小写字母。

### Output Format

输出到文件choose.out中。

输出一行表示最大的匹配值。

### Sample

#### Input

```
5
gennady
galya
boris
bill
toshik
bilbo
torin
gendalf
smaug
galadriel
```

#### Output

```
11
```

### Constraints

对于30%的数据，保证n<=500；

对于100%的数据，保证n<=100000，读入数据<=3000kb；

## Problem 3 生日(birthday.cpp/1s/256m)

### Desciption

9102年，科学家在离太阳很远之外发现一颗恒星叫许愿星，许愿星有一个行星叫夏之星，夏之星上的理化性质和地球相似，也存在大气层，适合人类居住。夏之星公转的周期是v天，所以夏之星一年有v天。

夏之星的南山幼儿园内计划了许多场生日派对。

现在有n个小朋友，编号为1~n。

每次生日派对校长会初选择[L,R]区间内的小朋友参加生日派对，再由老师决定在校长选中的小朋友中挑选出部分小朋友分为两个集合，一个集合的小朋友上午参加派对，一个集合的小朋友下午参加派对。

编号为i的孩子，对应的礼物的花费会为a[i] + 1。当上午参加的小朋友的礼物总花费和下午参加的小朋友礼物总花费不同时，就会引起花费少一方的小朋友的家长的不满，从而收到他们的投诉。

每次派对老师要仔细挑选参加派对的小朋友，尽量避免投诉。现在方老师怀孕了，会休假很长时间，拜托你来帮她代管她们班的小朋友。你不仅要负责划分好参加生日派对的小朋友，还要负责采购礼物和调查礼物价格的浮动。

相信聪明的你一定能解决这个问题



### Input Format

一行3个正整数，分别表示n,m,v。分别表示有n个小朋友，生日派对或礼物价格变化总共m次，夏之星一年有v天。

之后一行n个整数，第i个整数表示初始第i个小朋友礼物的价格为ai。

之后m行每行三个数，opt，l，r。

opt为1表示举办一场生日派对，校长选择区间为[l，r]。你需在[l，r]内挑选两个非空集合X，Y，满足：

1,X和Y没有交集,即同一个小朋友不能同时出现在X集合和Y集合

2，设集合X有一个小朋友为x，则花费为a[x] + 1，要求集合X总花费和集合Y元素的总花费相等。

如果能选择出这两个集合输出Yes，如果不能输出No。

opt为2表示礼物价格有变动。区间为[l，r]的小朋友所对应的礼物花费从a[x]变化为a[x]*a[x]*a[x] % v，即区间立方模v。


### Output Format

设操作1有c次，输出c行，每行一个字符串Yes或No表示能否选出这两个集合

一行一个整数，即答案

### Sample

#### Input

```
20 20 152

3 26 133 54 79 81 72 109 66 91 82 100 35 23 104 17 51 114 12 58

2 1 17

2 6 12

1 1 12

2 3 5

2 11 11

2 7 19

2 6 15

1 5 12

1 1 9

1 10 19

2 3 19

2 6 20

2 1 13

2 1 15

2 1 9

1 1 1

2 1 7

2 7 19

2 6 19

2 3 6
```

#### Output

```
Yes
Yes
Yes
Yes
No
```

#### Constraints

对于10%的数据，保证只有操作2

对于另外20%的数据，保证r - l + 1 <= 7

对于另外30%的数据，保证只有操作1

对于100%的数据，保证n，m<=100000，v<=1000，a[i] < v