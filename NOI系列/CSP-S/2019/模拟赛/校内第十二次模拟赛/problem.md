# 							 NOIP Day1 

| 题目名称       | 删点游戏 | 迷路       | 魔术      |
| -------------- | -------- | ---------- | --------- |
| 题目类型       | 传统型   | 传统型     | 传统型    |
| 输入文件名     | dt.in    | expand.in  | magic.in  |
| 输出文件名     | dt.out   | expand.out | magic.out |
| 每个测试点时限 | 1s       | 1s         | 2s        |
| 内存限制       | 128M     | 512M       | 512M      |
| 测试点数目     | 10       | 10         | 10        |
| 每个测试点分值 | 10       | 10         | 10        |

提交源程序文件名

| 对于C++   语言 | dt.cpp | expand.cpp | magic.cpp |
| -------------- | ------ | ---------- | --------- |
| 对于C     语言 | dt.c   | expand.c   | magic.c   |
| 对于Pascal语言 | dt.pas | expand.pas | magic.pas |

编译选项

| 对于C++   语言 | -lm  | -lm  | -lm  |
| -------------- | ---- | ---- | ---- |
| 对于C     语言 | -lm  | -lm  | -lm  |
| 对于Pascal语言 |      |      |      |

## Problem 1 删点游戏(dt.cpp/dt.in/dt.out)

### Description

​	Marah现在有一张n个点m条边的无向图,每个点都有一个点权。

​	Marah想通过将这些点一个一个的删掉来把这张图删干净。删掉一个点是有代价的，其大小等于与这个点相邻的未被删掉的点的权值之和。

​	Marah想请你帮她求出最小的代价。

### Input Format

​	第一行两个数n,m.

​    第二行n个数,第i个数$A_i$表示i这个点的点权。

​    接下来m行,每行两个数u,v，表示有一条连接u,v的边。数据保证任意两个点之间最多一条边相连，并且不存在自环。

### Output Format

​	你需要输出最小的代价是多少

### Sample

#### Input
```
4 3
40 20 30 10
1 4
2 4
2 3
```



#### Output

```
40
```



### Explanation

​	一个合理的方法是先删1号点，此时有10点代价。接下来删3号点，获得20点代价，再删2号点，获得10点代价，最后删4号点，没有代价。总计40点疲劳值。



### Constraints

对于30%的数据n<=10。

对于60%的数据n,m<=1000。

对于100%的数据1<=n,m,ai<=100000

 

---



## Problem 2 迷路（expand.cpp / expand.in / expand.out ）

### Description

​	Marah要出去买菜，但不小心迷路了，它记得所有菜店的坐标，也知道它现在的坐标。请你帮帮她，找到一条买完菜的路吧。它已经急得快哭了，它想要买完菜回家。因此它需要你找到一条最短的路买菜。

​	她穿上了最新研发的机甲，这个机甲的体格能够变化， 为了使自己尽量炫酷，她因此它希望在路径最短的情况下使自己的体格最大，即在移动时离障碍尽可能远。因为你开着上帝视角，所以你知道小T所在的地图。你能帮它找到一条路吗？

​	注意：
1、此处的离障碍最远是保证在任何时候、在保证路径最短的情况下离障碍最远。当然小T只需要你保证
在每个位置的体格之和尽可能大。

2、不需要考虑小T回家的路

### Input Format

第一行两个数$n, m,s$ ，表示小T所在的地图大小和小T的最大体格。
体格为$i$ 表示小T会占据 $(2i+1)\times (2i+1)$个格子。
接下来$n$ 行每行 $m$个数字表示地图，其中‘1’表示障碍，'0'表示空地。
接下来一行三个数 $x,y,p$表示小T所在的坐标 $(x,y)$和菜店数量 $p$。
接下来$p$ 行，第 两个数表示菜店$i$ 所在的坐标。

### Output Format

输出两个数，表示最短路长度以及每个位置的体格之和。

### Sample

#### Input1

```
4 5 3
0 1 1 1 0
0 0 0 0 0
0 0 0 0 0
0 0 0 0 0
0 4 1
0 0
```

#### Output1

```
6 0
```

#### Input2

```
4 6 3
1 1 1 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
0 0 0 0 0 0
0 4 1
3 0
```

#### Output2

```
7 5
```



### Constraints

对于 20%的数据，所有菜市位置和小T所在的位置在一条水平直线上。

对于另外 30%的数据，$s=0$ ，其中 20%的数据还满足$n,m \le 50$

对于另外20% 的数据， $p=1$

对于100%的数据， $n,m \le 300, s \le 10, p \le 15$

---



## Problem3 魔术(magic.cpp/magic.in/magic.out)

### Description

Marah是一名魔法师，她生活的大陆上有n 座城市，城市之间通过 m条路径相连， 每条路径都以一个权值 。有
一天，她突然想去 $n$号城市玩。

但是她很懒，于是她在路上行走的时候会用一点小小的法术，改变一下两座城之间的距离

但是她的法力也是很珍贵的，所以她决定，如果从她的家里出发，到达某个城市所经过的所有路径的权值的**最**
**大公约数**为$g$ ，从该城市出发前往下一个城市的路径的权值为$w$ ，则 经过这条路的时候会施法将这条路的路程缩
短为 $ \frac {w}{gcd(g,w)}$.

现在Marah有Q个家，她告诉了你这Q个家在哪，并请你告诉她这Q个家到$n$号城市的最短距离。



### Input Format

第一行两个数$n,m$ ，表示有$n$ 座城市， $m$条道路

接下来$m$ 行，每行三个数 $u,v,w$，表示 $u$号城市和 $v$号城市之间有一条权值为 $w$的路

接下来一行一个数$Q$，表示Marah有$Q$个家

接下来$Q$行，其实第$i$行有一个数$p_i$,表示H的第i个家在$P_i$号城市



### Output Format

输出$Q$行，第$i$ 行输出一个数表示 Marah的第 $i$个家到 $n$号城市的最短距离

### Sample

#### Input1

```
4 3
1 2 2
2 3 4
3 4 6
3
1
2
3

```

#### Output1

```
6
4
1
```

#### Input2

```
10 20
3 4 34
1 5 97
4 1 85
7 8 81
6 1 23
8 3 57
5 2 77
9 1 68
10 3 95
2 10 68
8 5 21
6 8 68
5 7 34
2 8 91
2 7 37
3 7 68
2 9 68
8 4 68
5 10 68
2 8 68
7
1
7
4
6
3
9
5
```

#### Output2

```
3
3
3
3
1
2
1
```

### Constraints

对于20%的数据,有$2 \le n \le 10$, $ 1 \le q \le 10$, $m \le 100$

对于50%的数据,有$2 \le n \le 100$ $ 1 \le q \le 100$, $m \le 500$

对所有数据:

$ 2 \le n \le 1000$

$n-1\le m \le 2000$,保证每个点均可到达$n$

$1 \le q \le 1e5$

$1 \le max(w) \le 500$